<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>LCD Smartie - A free open-source LCD program!</title>
  <!-- start of head.html -->
  <!--#include virtual="head.html" -->
  <!-- end of head.html -->
</head>
<body>
  <!--#set var="changed" value="\$Author: clansley $ \$Date: 2005/01/07 21:22:58 $ \$Revision: 1.9 $" -->
  <!--#set var="file" value="index" -->

  <!-- start of header.html -->
  <!--#include virtual="header.html" -->
  <!-- end of header.html -->

  <!-- start of sidebar.html -->
  <!--#include virtual="sidebar.html" -->
  <!-- end of sidebar.html -->
  <div id="content">
	<h1>Plugin interface</h1>

	<p>The current plugin interface isn't very pretty, but it's useable.</p>
	<h2>Using a plugin</h2>
	<p>
	The $dll function is used to access plugins. <br />
	It's syntax is: $dll([dllname],[function_number],[parameter1],[parameter2])<br />
	An example: $dll(demo.dll,5,hello,there)<br />
	This will call "function5" in demo.dll with the parameters hello and there, and then display it's output on the display.

	<h2>Writing a plugin</h2>
	<p>The source to simple demo plugins are available:</p>
	<ul>
		<li>in Delphi: <a href="http://prdownloads.sourceforge.net/lcdsmartie/Delphidemoplugin.zip?download">ZIP</a> or just <a href="http://cvs.sourceforge.net/viewcvs.py/lcdsmartie/lcdsmartie/DLL%20example/Delphi%20demo%20plugin/demo.dpr?view=markup">main source file</a></li>
		<li>in C/C++: <a href="http://prdownloads.sourceforge.net/lcdsmartie/DemoC%2B%2BPlugin.zip?download">ZIP</a> or just <a href="http://cvs.sourceforge.net/viewcvs.py/lcdsmartie/lcdsmartie/DLL%20example/DemoC%2B%2BPlugin/demo.cpp?view=markup">main source file</a></li>
		<li>in vb.net: <a href="http://prdownloads.sourceforge.net/lcdsmartie/vbdotnetplugin.zip?download">ZIP</a> or just <a href="http://cvs.sourceforge.net/viewcvs.py/lcdsmartie/lcdsmartie/DLL%20example/vbdotnetplugin/Class1.vb?view=markup">main source file</a></li>
		<li>in vc++.net: <a href="http://prdownloads.sourceforge.net/lcdsmartie/vcppdotnetplugin.zip?download">ZIP</a> or just <a href="http://cvs.sourceforge.net/viewcvs.py/lcdsmartie/lcdsmartie/DLL%20example/vcppdotnetplugin/vcppdotnetplugin.h?view=markup">main header file</a></li>
		<li>in c#: <a href="http://prdownloads.sourceforge.net/lcdsmartie/csharpplugin.zip?download">ZIP</a> or just <a href="http://cvs.sourceforge.net/viewcvs.py/lcdsmartie/lcdsmartie/DLL%20example/csharpplugin/Class1.cs?view=markup">main source file</a></li>
	</ul>
	<p>A plugin is a dll that is placed in the plugins subdirectory.</p>
	<h3>Non-.net plugins</h3>
	<p>
	The expected prototype of the exported function is (in delphi):
	<ul>
		<li>Function function1(param1:pchar;param2:pchar):pchar; stdcall;</li>
	</ul>
	</p>
	<p>The dll need not be written in Delphi, it can be written in any language.</p>
	<p>In C the expected prototype would be:
	<ul>
		<li>__declspec(dllexport) char*   __stdcall function1(char *param1, char *param2); </li>
	</ul></p>
	<p>In C++ it would be:
	<ul>
		<li>__declspec(dllexport) extern &quot;C&quot;  char*   __stdcall function1(char *param1, char *param2);</li>
	</ul>
	The important thing to remember is to use the &quot;stdcall&quot; calling convention.</p>
	<p>You can have up to 10 (20 in 5.3 beta3+) functions (i.e. function1 to function20).</p>
	<p>If your plugin has a SmartieInit function (which takes no parameters) then it will be called when you plugin is first loaded.</p>
	<h3>.net plugins</h3>
	<p>In LCD Smartie 5.3 beta 3 and above, .net plugins are supported.</p>
	<p>Your .net assembly/dll needs to provide a public class called "LCDSmartie" with member functions called function1, function2, etc (upto function20). You only need to provide the functions you want.  They need to return a String and take two Strings as parameters. </p>

	<p>When the plugin is loaded, an instance of that class will be created (the default constructor will be called).</p>

	<p>To load your plugin use your dll's name in the $dll command. Smartie will automatically detect that it's a .net plugin and just work.</p>

	<p>Expected member function prototypes:
	<ul>
		<li>vb.net: Public Function function1(ByVal param1 As String, ByVal param2 As String) As String</li>
		<li>VC++.net: String __gc *function1(String *param1, String *param2)</li>
		<li>C#:  string function1(string param1, string param2)</li>
	</ul>


	<h2>Tips</h2>

	<p><strong>Tip:</strong> Although only two parameters are passed, you can use more by parsing the parameters, for example $dll(demo.dll,5,param1#param2,param3) could be used and the real 1st parameter (param1#param2) could be parsed into two parameters (param1 and param2).</p>
		
	<p><strong>Tip:</strong> Although only strings are passed, you can still use numbers.  You simply convert the strings into numbers, perform your calculation and then convert the result back to a string.</p>

	<p><strong>Warning:</strong> Your dll will be called when ever the screen that references your dll is displayed and as often as the &quot;DLL check interval&quot; on the Misc settings tab (by default this is every 250ms). It's wise not to do any work that will take a long period of time because the whole of smartie will be blocked until the function returns. It's best to create a thread to do the real work, and the exported function simply copys out the cached result. </p>

</div>
  <!-- start of footer.html -->
  <!--#include virtual="footer.html" -->
  <!-- end of footer.html -->
</body>
</html>
